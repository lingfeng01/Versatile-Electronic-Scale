C51 COMPILER V9.59.0.0   I2C                                                               12/23/2024 17:50:39 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE I2C
OBJECT MODULE PLACED IN .\Objects\I2C.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE divers\I2C.c LARGE OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(.\App;.\divers;.
                    -\main) DEBUG PRINT(.\Listings\I2C.lst) TABS(2) OBJECT(.\Objects\I2C.obj)

line level    source

   1          #include "I2C.h"
   2          
   3          
   4          /**
   5           * @brief I2C启动
   6           *
   7           */
   8          void I2C_Start()
   9          {
  10   1          busy = 1;
  11   1          I2CMSCR = 0x81;
  12   1          while (busy)
  13   1          {
  14   2          }
  15   1      }
  16          
  17          /**
  18           * @brief I2C停止
  19           *
  20           */
  21          void I2C_Stop()
  22          {
  23   1      
  24   1          busy = 1;
  25   1          I2CMSCR = 0x86;
  26   1          while (busy)
  27   1          {
  28   2          }
  29   1      }
  30          
  31          /**
  32           * @brief I2C发送数据
  33           *
  34           * @param dat
  35           */
  36          void I2C_SendData(uchar dat)
  37          {
  38   1          I2CTXD = dat;
  39   1          busy = 1;
  40   1          I2CMSCR = 0x82;
  41   1          while (busy)
  42   1          {
  43   2          }
  44   1      }
  45          
  46          /**
  47           * @brief I2C接收应答
  48           *
  49           */
  50          void Recv_Ack()
  51          {
  52   1          busy = 1;
  53   1          I2CMSCR = 0x83;
  54   1          while (busy)
C51 COMPILER V9.59.0.0   I2C                                                               12/23/2024 17:50:39 PAGE 2   

  55   1          {
  56   2          }
  57   1      }
  58          
  59          /**
  60           * @brief I2C接收数据
  61           *
  62           * @return char
  63           */
  64          char I2C_RecvData()
  65          {
  66   1          busy = 1;
  67   1          I2CMSCR = 0x84;
  68   1          while (busy)
  69   1          {
  70   2          }
  71   1          return I2CRXD;
  72   1      }
  73          
  74          /**
  75           * @brief I2C发送ACK
  76           *
  77           */
  78          void I2C_SendAck()
  79          {
  80   1          I2CMSST = 0x00;
  81   1          busy = 1;
  82   1          I2CMSCR = 0x85;
  83   1          while (busy)
  84   1          {
  85   2          }
  86   1      }
  87          
  88          /**
  89           * @brief I2C发送NACK
  90           *
  91           */
  92          void I2C_SendNAck()
  93          {
  94   1          I2CMSST = 0x01;
  95   1          busy = 1;
  96   1          I2CMSCR = 0x85;
  97   1          while (busy)
  98   1          {
  99   2          }
 100   1      }
 101          
 102          void I2C_Init()
 103          {
 104   1          I2CCFG = 0xe0;
 105   1          I2CMSST = 0x00;
 106   1          EA = 1;
 107   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    119    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
C51 COMPILER V9.59.0.0   I2C                                                               12/23/2024 17:50:39 PAGE 3   

   BIT SIZE         =      1    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
