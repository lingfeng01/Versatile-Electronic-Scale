C51 COMPILER V9.59.0.0   I2C                                                               12/24/2024 17:25:25 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE I2C
OBJECT MODULE PLACED IN .\Objects\I2C.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE divers\I2C.c LARGE OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(.\App;.\divers;.
                    -\main) DEBUG PRINT(.\Listings\I2C.lst) TABS(2) OBJECT(.\Objects\I2C.obj)

line level    source

   1          #include "I2C.h"
   2          
   3          /**
   4           * @brief I2C启动
   5           *
   6           */
   7          void I2C_Start()
   8          {
   9   1          busy = 1;
  10   1          I2CMSCR = 0x81;
  11   1          while (busy)
  12   1          {
  13   2          }
  14   1      }
  15          
  16          /**
  17           * @brief I2C停止
  18           *
  19           */
  20          void I2C_Stop()
  21          {
  22   1      
  23   1          busy = 1;
  24   1          I2CMSCR = 0x86;
  25   1          while (busy)
  26   1          {
  27   2          }
  28   1      }
  29          
  30          /**
  31           * @brief I2C发送数据
  32           *
  33           * @param dat
  34           */
  35          void I2C_SendData(uchar dat)
  36          {
  37   1          I2CTXD = dat;
  38   1          busy = 1;
  39   1          I2CMSCR = 0x82;
  40   1          while (busy)
  41   1          {
  42   2          }
  43   1      }
  44          
  45          /**
  46           * @brief I2C接收应答
  47           *
  48           */
  49          void Recv_Ack()
  50          {
  51   1          busy = 1;
  52   1          I2CMSCR = 0x83;
  53   1          while (busy)
  54   1          {
C51 COMPILER V9.59.0.0   I2C                                                               12/24/2024 17:25:25 PAGE 2   

  55   2          }
  56   1      }
  57          
  58          /**
  59           * @brief I2C接收数据
  60           *
  61           * @return char
  62           */
  63          char I2C_RecvData()
  64          {
  65   1          busy = 1;
  66   1          I2CMSCR = 0x84;
  67   1          while (busy)
  68   1          {
  69   2          }
  70   1          return I2CRXD;
  71   1      }
  72          
  73          /**
  74           * @brief I2C发送ACK
  75           *
  76           */
  77          void I2C_SendAck()
  78          {
  79   1          I2CMSST = 0x00;
  80   1          busy = 1;
  81   1          I2CMSCR = 0x85;
  82   1          while (busy)
  83   1          {
  84   2          }
  85   1      }
  86          
  87          /**
  88           * @brief I2C发送NACK
  89           *
  90           */
  91          void I2C_SendNAck()
  92          {
  93   1          I2CMSST = 0x01;
  94   1          busy = 1;
  95   1          I2CMSCR = 0x85;
  96   1          while (busy)
  97   1          {
  98   2          }
  99   1      }
 100          
 101          void I2C_Init()
 102          {
 103   1          I2CCFG = 0xe0;
 104   1          I2CMSST = 0x00;
 105   1          EA = 1;
 106   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    119    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
C51 COMPILER V9.59.0.0   I2C                                                               12/24/2024 17:25:25 PAGE 3   

   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
